<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tutorials/scalable_constrained_bo/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Scalable Constrained Bayesian Optimization (SCBO) | BoTorch</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://botorch.org/botorch/img/botorch.png"><meta data-rh="true" name="twitter:image" content="https://botorch.org/botorch/img/botorch.png"><meta data-rh="true" property="og:url" content="https://botorch.org/botorch/docs/tutorials/scalable_constrained_bo/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Scalable Constrained Bayesian Optimization (SCBO) | BoTorch"><meta data-rh="true" name="description" content="&lt;LinkButtons"><meta data-rh="true" property="og:description" content="&lt;LinkButtons"><link data-rh="true" rel="icon" href="/botorch/img/botorch.ico"><link data-rh="true" rel="canonical" href="https://botorch.org/botorch/docs/tutorials/scalable_constrained_bo/"><link data-rh="true" rel="alternate" href="https://botorch.org/botorch/docs/tutorials/scalable_constrained_bo/" hreflang="en"><link data-rh="true" rel="alternate" href="https://botorch.org/botorch/docs/tutorials/scalable_constrained_bo/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://4ROLHRP5JS-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="BoTorch" href="/botorch/opensearch.xml">
<link rel="stylesheet" href="/css/code_block_buttons.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/js/code_block_buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><link rel="stylesheet" href="/botorch/assets/css/styles.0e4f1a4a.css">
<script src="/botorch/assets/js/runtime~main.f161196b.js" defer="defer"></script>
<script src="/botorch/assets/js/main.35ba8604.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/botorch/"><div class="navbar__logo"><img src="/botorch/img/botorch.png" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/botorch/img/botorch.png" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">BoTorch</b></a><a class="navbar__item navbar__link" href="/botorch/docs/introduction">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/botorch/docs/tutorials/">Tutorials</a><a href="https://botorch-dev.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/botorch/docs/papers">Papers</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/botorch/docs/tutorials/scalable_constrained_bo/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/botorch/docs/tutorials/scalable_constrained_bo/">Next</a></li><li><hr class="margin-vert--sm"></li><li class="margin-horiz--sm text--bold"><small>Archived versions<small></small></small></li><li><a href="https://botorch.org/versions" target="_blank" rel="noopener noreferrer" class="dropdown__link">&lt;= 0.11.3<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/pytorch/botorch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/botorch/docs/tutorials/">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/">Overview</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/botorch/docs/tutorials/custom_botorch_model_in_ax/">Using BoTorch with Ax</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/botorch/docs/tutorials/closed_loop_botorch_only/">Full Optimization Loops</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/closed_loop_botorch_only/">q-Noisy Constrained EI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/preference_bo/">Bayesian optimization with pairwise comparison data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/bope/">Bayesian optimization with preference exploration (BOPE)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/turbo_1/">Trust Region Bayesian Optimization (TuRBO)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/baxus/">Bayesian optimization with adaptively expanding subspaces (BAxUS)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/botorch/docs/tutorials/scalable_constrained_bo/">Scalable Constrained Bayesian Optimization (SCBO)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/saasbo/">High-dimensional Bayesian optimization with SAASBO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/cost_aware_bayesian_optimization/">Cost-aware Bayesian optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/Multi_objective_multi_fidelity_BO/">Multi-Objective-Multi-Fidelity optimization with MOMF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/bo_with_warped_gp/">Bayesian optimization with input warping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/thompson_sampling/">Bayesian optimization with large-scale Thompson sampling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/ibnn_bo/">Bayesian optimization with infinite-width neural networks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/botorch/docs/tutorials/custom_model/">Writing a custom model with the Model and Posterior Interfaces</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/botorch/docs/tutorials/multi_objective_bo/">Multi-Objective Bayesian Optimization</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/botorch/docs/tutorials/fit_model_with_torch_optimizer/">Bite-Sized Tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/botorch/docs/tutorials/meta_learning_with_rgpe/">Advanced Usage</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/botorch/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Full Optimization Loops</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Scalable Constrained Bayesian Optimization (SCBO)</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="margin-top--sm margin-bottom--lg"><a href="https://github.com/cristianlara/botorch/blob/main/tutorials/scalable_constrained_bo/scalable_constrained_bo.ipynb" target="_blank" rel="noopener noreferrer" class="button button--outline button--primary margin-right--xs">Open in GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://colab.research.google.com/github/cristianlara/botorch/blob/main/tutorials/scalable_constrained_bo/scalable_constrained_bo.ipynb" target="_blank" rel="noopener noreferrer" class="button button--outline button--primary margin--xs">Run in Google Colab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div>
<header><h1>Scalable Constrained Bayesian Optimization (SCBO)</h1></header>
<p>In this tutorial, we show how to implement Scalable Constrained Bayesian Optimization
(SCBO) [1] in a closed loop in BoTorch.</p>
<p>We optimize the 10𝐷 Ackley function on the domain <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>5</mn><mo separator="true">,</mo><mn>10</mn><msup><mo stretchy="false">]</mo><mn>10</mn></msup></mrow><annotation encoding="application/x-tex">[−5,10]^{10}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">10</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span></span></span></span>. This implementation
uses two simple constraint functions <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">c1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord mathnormal">c</span><span class="mord">1</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">c2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord mathnormal">c</span><span class="mord">2</span></span></span></span>. Our goal is to find an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span> that
maximizes the Ackley function subject to the constraints <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">c1(x) \leq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span> and
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">c2(x) \leq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span>.</p>
<p>[1]: David Eriksson and Matthias Poloczek. Scalable constrained Bayesian optimization.
In International Conference on Artificial Intelligence and Statistics, pages 730–738.
PMLR, 2021. (<a href="https://doi.org/10.48550/arxiv.2002.08526" target="_blank" rel="noopener noreferrer">https://doi.org/10.48550/arxiv.2002.08526</a>)</p>
<p>Since SCBO is essentially a constrained version of Trust Region Bayesian Optimization
(TuRBO), this tutorial shares much of the same code as the TuRBO Tutorial
(<a href="https://botorch.org/tutorials/turbo_1" target="_blank" rel="noopener noreferrer">https://botorch.org/tutorials/turbo_1</a>) with small modifications made to implement SCBO.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Install dependencies if we are running in colab</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;google.colab&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> sys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">modules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">%</span><span class="token plain">pip install botorch</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> math</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> warnings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> dataclasses </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> dataclass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> gpytorch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> gpytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">constraints </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Interval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> gpytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">kernels </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MaternKernel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ScaleKernel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> gpytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">likelihoods </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GaussianLikelihood</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> gpytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mlls </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ExactMarginalLogLikelihood</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> torch </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Tensor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">quasirandom </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SobolEngine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fit </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> fit_gpytorch_mll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Constrained Max Posterior Sampling s a new sampling class, similar to MaxPosteriorSampling,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># which implements the constrained version of Thompson Sampling described in [1].</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">generation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sampling </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ConstrainedMaxPosteriorSampling</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> SingleTaskGP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">model_list_gp_regression </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> ModelListGP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">models</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transforms</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">outcome </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Standardize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test_functions </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Ackley</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> botorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">utils</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transforms </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> unnormalize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">warnings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;ignore&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;cuda&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cuda</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_available</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;cpu&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtype </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">double</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tkwargs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;device&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> device</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dtype&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> dtype</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SMOKE_TEST </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SMOKE_TEST&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="demonstration-with-10-dimensional-ackley-function-and-two-simple-constraint-functions">Demonstration with 10-dimensional Ackley function and Two Simple Constraint Functions<a href="#demonstration-with-10-dimensional-ackley-function-and-two-simple-constraint-functions" class="hash-link" aria-label="Direct link to Demonstration with 10-dimensional Ackley function and Two Simple Constraint Functions" title="Direct link to Demonstration with 10-dimensional Ackley function and Two Simple Constraint Functions">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Here we define the example 10D Ackley function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Ackley</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> negate</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">**</span><span class="token plain">tkwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bounds</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fill_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bounds</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fill_</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dim </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bounds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">batch_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">n_init </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_cholesky_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;inf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Always use Cholesky</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># When evaluating the function, we must first unnormalize the inputs since</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># we will use normalized inputs x in the main optimizaiton loop</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">eval_objective</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;This is a helper function we use to unnormalize and evalaute a point&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unnormalize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bounds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-two-simple-constraint-functions">Defining two simple constraint functions<a href="#defining-two-simple-constraint-functions" class="hash-link" aria-label="Direct link to Defining two simple constraint functions" title="Direct link to Defining two simple constraint functions">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="well-use-two-constraints-functions-c1-and-c2">We&#x27;ll use two constraints functions: c1 and c2<a href="#well-use-two-constraints-functions-c1-and-c2" class="hash-link" aria-label="Direct link to We&#x27;ll use two constraints functions: c1 and c2" title="Direct link to We&#x27;ll use two constraints functions: c1 and c2">​</a></h4>
<p>We want to find solutions which maximize the above Ackley objective subject to the
constraint that c1(x) &lt;= 0 and c2(x) &lt;= 0 Note that SCBO expects all constraints to be
of the for c(x) &lt;= 0, so any other desired constraints must be modified to fit this
form.</p>
<p>Note also that while the below constraints are very simple functions, the point of this
tutorial is to show how to use SCBO, and this same implementation could be applied in
the same way if c1, c2 were actually complex black-box functions.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">c1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Equivalent to enforcing that sum(x) &lt;= 0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">c2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Equivalent to enforcing that ||x||_2 &lt;= 5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">norm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> p</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># We assume c1, c2 have same bounds as the Ackley function above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">eval_c1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;This is a helper function we use to unnormalize and evalaute a point&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> c1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unnormalize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bounds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">eval_c2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;This is a helper function we use to unnormalize and evalaute a point&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> c2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unnormalize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">bounds</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="define-turbo-class">Define TuRBO Class<a href="#define-turbo-class" class="hash-link" aria-label="Direct link to Define TuRBO Class" title="Direct link to Define TuRBO Class">​</a></h2>
<p>Just as in the TuRBO Tutorial (<a href="https://botorch.org/tutorials/turbo_1" target="_blank" rel="noopener noreferrer">https://botorch.org/tutorials/turbo_1</a>), we&#x27;ll define a
class to hold the turst region state and a method update_state() to update the side
length of the trust region hyper-cube during optimization. We&#x27;ll update the side length
according to the number of sequential successes or failures as discussed in the original
TuRBO paper.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token decorator annotation punctuation" style="color:#393A34">@dataclass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ScboState</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dim</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    length</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    length_min</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token operator" style="color:#393A34">**</span><span class="token number" style="color:#36acaa">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    length_max</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    failure_counter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    failure_tolerance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;nan&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Note: Post-initialized</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    success_counter</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    success_tolerance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Note: The original paper uses 3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    best_value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;inf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    best_constraint_values</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Tensor </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ones</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">tkwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">inf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restart_triggered</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__post_init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_tolerance </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ceil</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">4.0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">update_tr_length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ScboState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Update the length of the trust region according to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># success and failure counters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (Just as in original TuRBO paper)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_counter </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_tolerance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Expand trust region</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length_max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elif</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_counter </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_tolerance</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Shrink trust region</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">/=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length_min</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Restart when trust region becomes too small</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restart_triggered </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_best_index_for_batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Y</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Tensor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Tensor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Return the index for the best point.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    is_feas </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> is_feas</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Choose best feasible candidate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">~</span><span class="token plain">is_feas</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;inf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> score</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> C</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argmin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">update_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Y_next</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Method used to update the TuRBO state after each step of optimization.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Success and failure counters are updated according to the objective values</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    (Y_next) and constraint values (C_next) of the batch of candidate points</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    evaluated on the optimization step.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    As in the original TuRBO paper, a success is counted whenver any one of the</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    new candidate points improves upon the incumbent best point. The key difference</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    for SCBO is that we only compare points by their objective values when both points</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    are valid (meet all constraints). If exactly one of the two points being compared</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    violates a constraint, the other valid point is automatically considered to be better.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    If both points violate some constraints, we compare them inated by their constraint values.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    The better point in this case is the one with minimum total constraint violation</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    (the minimum sum of constraint values)&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Pick the best point from the batch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    best_ind </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_best_index_for_batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Y</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Y_next</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">C_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y_next</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Y_next</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">best_ind</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C_next</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">best_ind</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c_next </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># At least one new candidate is feasible</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        improvement_threshold </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_value </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1e-3</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fabs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> y_next </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> improvement_threshold </span><span class="token keyword" style="color:#00009f">or</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_constraint_values </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_counter </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> y_next</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_constraint_values </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c_next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_counter </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># No new candidate is feasible</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        total_violation_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c_next</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        total_violation_center </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_constraint_values</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> total_violation_next </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> total_violation_center</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_counter </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> y_next</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_constraint_values </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> c_next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success_counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">failure_counter </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Update the length of the trust region according to the success and failure counters</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> update_tr_length</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> state</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define example state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ScboState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div style="background-color:var(--ifm-pre-background);margin-bottom:10px;border-radius:var(--ifm-global-radius);overflow:hidden;padding:5px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit;padding:8px"><p style="margin-bottom:0px">ScboState(dim=10, batch_size=4, length=0.8, length_min=0.0078125, length_max=1.6, failure_counter=0, failure_tolerance=3, success_counter=0, success_tolerance=10, best_value=-inf, best_constraint_values=tensor([inf, inf], dtype=torch.float64), restart_triggered=False)</p></pre></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generate-initial-points">Generate Initial Points<a href="#generate-initial-points" class="hash-link" aria-label="Direct link to Generate Initial Points" title="Direct link to Generate Initial Points">​</a></h3>
<p>Here we define a simple method to generate a set of random initial datapoints that we
will use to kick-off optimization.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_initial_points</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_pts</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seed</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sobol </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SobolEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dimension</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scramble</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seed</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">seed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_init </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sobol</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">n_pts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dtype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X_init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generating-a-batch-of-candidates-for-scbo">Generating a batch of candidates for SCBO<a href="#generating-a-batch-of-candidates-for-scbo" class="hash-link" aria-label="Direct link to Generating a batch of candidates for SCBO" title="Direct link to Generating a batch of candidates for SCBO">​</a></h3>
<p>Just as in the TuRBO Tutorial (<a href="https://botorch.org/tutorials/turbo_1" target="_blank" rel="noopener noreferrer">https://botorch.org/tutorials/turbo_1</a>), we&#x27;ll define a
method generate_batch to generate a new batch of candidate points within the TuRBO trust
region using Thompson sampling.</p>
<p>The key difference here from TuRBO is that, instead of using MaxPosteriorSampling to
simply grab the candidates within the trust region with the maximum posterior values, we
use ConstrainedMaxPosteriorSampling to instead grab the candidates within the trust
region with the maximum posterior values subject to the constraint that the posteriors
for the constraint models for c1(x) and c2(x) must be less than or equal to 0 for both
candidates.</p>
<p>We use additional GPs (&#x27;constraint models&#x27;) to model each black-box constraint (c1 and
c2), and throw out all candidates for which the sampled value for these constraint
models is greater than 0. According to [1], in the special case when all of the
candidaates are predicted to be constraint violators, we select the candidate with the
minimum predicted violation. (See
botorch.generation.sampling.ConstrainedMaxPosteriorSampling for implementation details).</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">generate_batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># GP model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Evaluated points on the domain [0, 1]^d</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Function values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Constraint values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n_candidates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Number of candidates for Thompson sampling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constraint_model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sobol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> SobolEngine</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">assert</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">isfinite</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Create the TR bounds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    best_ind </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_best_index_for_batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Y</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">C</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x_center </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">best_ind</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tr_lb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_center </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tr_ub </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_center </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Thompson Sampling w/ Constraints (SCBO)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dim </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> X</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sobol</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">draw</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_candidates</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dtype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tr_lb </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tr_ub </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tr_lb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> pert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Create a perturbation mask</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    prob_perturb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">20.0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_candidates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">tkwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> prob_perturb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ind </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">where</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mask</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mask</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ind</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">randint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ind</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Create candidate points from the perturbations and the mask</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_cand </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x_center</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">expand</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n_candidates</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    X_cand</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mask</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pert</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mask</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Sample on the candidate points using Constrained Max Posterior Sampling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    constrained_thompson_sampling </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ConstrainedMaxPosteriorSampling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> constraint_model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">constraint_model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> replacement</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">no_grad</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        X_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> constrained_thompson_sampling</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X_cand</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_samples</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> X_next</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="main-optimization-loop">Main Optimization Loop<a href="#main-optimization-loop" class="hash-link" aria-label="Direct link to Main Optimization Loop" title="Direct link to Main Optimization Loop">​</a></h2>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Generate initial data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_initial_points</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> n_init</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">train_Y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">eval_objective</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> train_X</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">tkwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">eval_c1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> train_X</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">tkwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">C2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">eval_c2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> train_X</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">**</span><span class="token plain">tkwargs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initialize TuRBO state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ScboState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Note: We use 2000 candidates here to make the tutorial run faster.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># SCBO actually uses min(5000, max(2000, 200 * dim)) candidate points by default.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N_CANDIDATES </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> SMOKE_TEST </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sobol </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SobolEngine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scramble</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> seed</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_fitted_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    likelihood </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GaussianLikelihood</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">noise_constraint</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Interval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1e-8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1e-3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    covar_module </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ScaleKernel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Use the same lengthscale prior as in the TuRBO paper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MaternKernel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nu</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2.5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ard_num_dims</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dim</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lengthscale_constraint</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Interval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.005</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> SingleTaskGP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        covar_module</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">covar_module</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        likelihood</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">likelihood</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outcome_transform</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Standardize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">m</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mll </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ExactMarginalLogLikelihood</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">likelihood</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> gpytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">settings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">max_cholesky_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_cholesky_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fit_gpytorch_mll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mll</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> model</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">restart_triggered</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Run until TuRBO converges</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Fit GP models for objective and constraints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_fitted_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> train_Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c1_model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_fitted_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c2_model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> get_fitted_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Generate a batch of candidates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> gpytorch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">settings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">max_cholesky_size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_cholesky_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        X_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> generate_batch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            state</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            X</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">train_X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Y</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">train_Y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            C</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            batch_size</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            n_candidates</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">N_CANDIDATES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            constraint_model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">ModelListGP</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c1_model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c2_model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            sobol</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">sobol</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Evaluate both the objective and constraints for the selected candidaates</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Y_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">eval_objective</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> X_next</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dtype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C1_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">eval_c1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> X_next</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dtype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C2_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tensor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">eval_c2</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> x </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> X_next</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dtype</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">dtype</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">device</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">unsqueeze</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C_next </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">C1_next</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C2_next</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Update TuRBO state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> update_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Y_next</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Y_next</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C_next</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">C_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Append data. Note that we append all data, even points that violate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># the constraints. This is so our constraint models can learn more</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># about the constraint functions and gain confidence in where violations occur.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    train_X </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_X</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> X_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    train_Y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_Y</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Y_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C1_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C2_next</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Print current status. Note that state.best_value is always the best</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># objective value found so far which meets the constraints, or in the case</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># that no points have been found yet which meet the constraints, it is the</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># objective value of the point with the minimum constraint violation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_constraint_values </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">train_X</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">) Best value: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">state</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">best_value</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, TR length: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">state</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">length</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        violation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">best_constraint_values</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clamp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">min</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">train_X</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">) No feasible point yet! Smallest total violation: &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">violation</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, TR length: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">state</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">length</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2e</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div style="background-color:var(--ifm-pre-background);margin-bottom:10px;border-radius:var(--ifm-global-radius);overflow:hidden;padding:5px;font:var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"><span style="color:red">Out: </span><pre style="margin:0px;background-color:inherit;padding:8px"><p style="margin-bottom:0px">14) No feasible point yet! Smallest total violation: 1.61e+01, TR length: 8.00e-01</p><p style="margin-bottom:0px">18) No feasible point yet! Smallest total violation: 8.45e+00, TR length: 8.00e-01</p><p style="margin-bottom:0px">22) No feasible point yet! Smallest total violation: 2.11e+00, TR length: 8.00e-01</p><p style="margin-bottom:0px">26) No feasible point yet! Smallest total violation: 2.11e+00, TR length: 8.00e-01</p><p style="margin-bottom:0px">30) No feasible point yet! Smallest total violation: 2.11e+00, TR length: 8.00e-01</p><p style="margin-bottom:0px">34) No feasible point yet! Smallest total violation: 2.11e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">38) No feasible point yet! Smallest total violation: 8.84e-01, TR length: 4.00e-01</p><p style="margin-bottom:0px">42) Best value: -6.17e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">46) Best value: -6.17e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">50) Best value: -5.94e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">54) Best value: -5.94e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">58) Best value: -5.81e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">62) Best value: -4.58e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">66) Best value: -4.58e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">70) Best value: -4.58e+00, TR length: 4.00e-01</p><p style="margin-bottom:0px">74) Best value: -4.58e+00, TR length: 2.00e-01</p><p style="margin-bottom:0px">78) Best value: -4.19e+00, TR length: 2.00e-01</p><p style="margin-bottom:0px">82) Best value: -2.97e+00, TR length: 2.00e-01</p><p style="margin-bottom:0px">86) Best value: -2.97e+00, TR length: 2.00e-01</p><p style="margin-bottom:0px">90) Best value: -2.97e+00, TR length: 2.00e-01</p><p style="margin-bottom:0px">94) Best value: -2.97e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">98) Best value: -2.41e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">102) Best value: -2.41e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">106) Best value: -2.41e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">110) Best value: -2.36e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">114) Best value: -2.36e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">118) Best value: -2.36e+00, TR length: 1.00e-01</p><p style="margin-bottom:0px">122) Best value: -2.36e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">126) Best value: -1.57e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">130) Best value: -1.57e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">134) Best value: -1.16e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">138) Best value: -1.16e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">142) Best value: -1.16e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">146) Best value: -1.05e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">150) Best value: -1.05e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">154) Best value: -1.05e+00, TR length: 5.00e-02</p><p style="margin-bottom:0px">158) Best value: -1.05e+00, TR length: 2.50e-02</p><p style="margin-bottom:0px">162) Best value: -4.22e-01, TR length: 2.50e-02</p><p style="margin-bottom:0px">166) Best value: -4.22e-01, TR length: 2.50e-02</p><p style="margin-bottom:0px">170) Best value: -4.22e-01, TR length: 2.50e-02</p><p style="margin-bottom:0px">174) Best value: -4.22e-01, TR length: 1.25e-02</p><p style="margin-bottom:0px">178) Best value: -3.24e-01, TR length: 1.25e-02</p><p style="margin-bottom:0px">182) Best value: -3.24e-01, TR length: 1.25e-02</p><p style="margin-bottom:0px">186) Best value: -3.24e-01, TR length: 1.25e-02</p><p style="margin-bottom:0px">190) Best value: -3.24e-01, TR length: 6.25e-03</p></pre></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="plot-results">Plot Results<a href="#plot-results" class="hash-link" aria-label="Direct link to Plot Results" title="Direct link to Plot Results">​</a></h3>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> matplotlib </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> rc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">matplotlib inline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ax </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">figsize</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> train_Y</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Set infeasible to -inf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">score</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">~</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> C2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">all</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;-inf&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">maximum</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">accumulate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpu</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> marker</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optimal_value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fun</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optimal_value</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;k--&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lw</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ylabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Function value&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fontsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xlabel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Number of evaluations&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fontsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;10D Ackley with 2 outcome constraints&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fontsize</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">xlim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">train_Y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ylim</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">grid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/image/png;base64,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q1b49NNPdc7aqd721KlTGDFiBCpUqAAnJye4uLigatWqePfdd3Hp0iUMGjTI5NjyM2HCBGzYsAGjRo1C48aNUbZsWTg6OsLR0RHlypVDr169sG3bNmzevFnndS44OBjHjx/HsGHDULFiRY0+tebo2LEjTpw4gQEDBkjHtbo9f/jhB+zZs8di37KZy5hzsG/fvti+fTvGjh2L5s2bIzw8HM7OznBwcEBISAi6d++OX3/9FQcOHNAY7agkkwlRAgbDI6IidfXqVWk0iDlz5pg9OQQREVFxZlu3SIjIKOrRCOzt7Qv1bg8REVFxwISYiDQkJibihx9+AJDTdUI9DSsREVFpxVEmiAgJCQlITk7GvXv3MH36dDx+/BgymUwa/o6IiKg0Y0JMRPjggw+wYsUKjWWjR4+WZnwiIiIqzZgQE5HEwcEBFSpUwIgRI/KdZIGIiKi04CgTRERERGTTeIfYRNnZ2bh37x7c3Nyk2a6IiIiIqPgQQuDp06cICgoyOM46E2IT3bt3D6GhodYOg4iIiIjycfv2bYSEhOhdz4TYRG5ubgCA2NhYeHt7WzmakkmlUmHXrl3o0KFDocx5byvYjuZjG1oG29F8bEPLYDtaRmlox+TkZISGhkp5mz5MiE2k7ibh5uYGd3d3K0dTMqlUKjg7O8Pd3b3EnmjFAdvRfGxDy2A7mo9taBlsR8soTe2YX/dWTsxBRERERDaNCTERERER2TQmxERERERk05gQExEREZFNY0JMRERERDaNCTERERER2TQmxERERERk05gQExEREZFNY0JMRERERDaNCTERERER2TQmxERERERk05gQExEREZFNY0JMRERERDaNCTERERER2TQmxERERERk05gQExEREZFNY0JMRERERDaNCTERERER2TQmxERERERk05gQExEREZFNY0JMRERERDaNCTERERER2TSbTogXLVqEcuXKwdHREY0aNcLx48etHRIRERERFTF7awdgLWvWrMG4ceOwePFiNGrUCF9//TU6duyIy5cvw9/f3+h6Hj58iOzs7ALv39XVFU5OTnrrFEIUuE4AcHZ2houLi851jx8/RlZWlkn1Ojo6ws3NTee6xMREqFSqAtepUqnw/PlzveuTkpKQkZFR4HoBQKFQwNPTU+e6p0+fIi0tzaR67ezs4O3trXPd8+fPkZKSYlK9MpkMvr6+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UneHOD9HjhxBzZo1ERAQIC3r2LEjRo0ahfPnz6Nu3bo6t0tPT0d6err0Ojk5GQCgUqmgUqkKN+hSSt1ubD/zsB3Nxza0DLaj+diGlsF2tIzS0I7Gxm5zCXF8fLxGMgxAeh0fH693u88//xwzZszQWh4dHQ1nZ2fLBmljoqKirB1CqcB2NB/b0DLYjuZjG1oG29EySnI7pqSkGFWuRCTEkyZNwpw5cwyWuXjxIqpUqVJoMUyePBnjxo2TXicnJyM0NBStW7eGj49Poe23NFOpVIiKikL79u2hUCisHU6JxXY0H9vQMtiO5mMbWgbb0TJKQzuqv9HPT4ES4vv378POzk7vekPrAEAmk5k0msP48eMxZMgQg2XKly9vVF2BgYE4fvy4xrL79+9L6/RRKpVQKpVayxUKRYk9SIoLtqFlsB3Nxza0DLaj+diGlsF2tIyS3I7Gxm2RcYgLm5+fH/z8/CxSV5MmTTBr1iwkJCTA398fQM5XAe7u7qhWrZpF9kFEREREJYfRCfG0adMKMw6LuXXrFh4/foxbt24hKysLp0+fBgBUrFgRrq6u6NChA6pVq4aBAwfiiy++QHx8PKZMmYIxY8bovANMRERERKVbqUuIp06dihUrVkiv1aNGREdHIzIyEnZ2dti2bRtGjRqFJk2awMXFBYMHD8bMmTOtFTIRERERWVGJeKiuIJYvX47ly5cbLBMWFobt27cXTUBEREREVKyVuok5iIiIiIgKggkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsREREREZNOYEBMRERGRTWNCTEREREQ2jQkxEREREdk0JsRE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" alt="" class="img_ev3q"></p>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"></code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/pytorch/botorch/edit/main/docs/../docs/tutorials/scalable_constrained_bo/index.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/botorch/docs/tutorials/baxus/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Bayesian optimization with adaptively expanding subspaces (BAxUS)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/botorch/docs/tutorials/saasbo/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">High-dimensional Bayesian optimization with SAASBO</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#demonstration-with-10-dimensional-ackley-function-and-two-simple-constraint-functions" class="table-of-contents__link toc-highlight">Demonstration with 10-dimensional Ackley function and Two Simple Constraint Functions</a><ul><li><a href="#defining-two-simple-constraint-functions" class="table-of-contents__link toc-highlight">Defining two simple constraint functions</a></li></ul></li><li><a href="#define-turbo-class" class="table-of-contents__link toc-highlight">Define TuRBO Class</a><ul><li><a href="#generate-initial-points" class="table-of-contents__link toc-highlight">Generate Initial Points</a></li><li><a href="#generating-a-batch-of-candidates-for-scbo" class="table-of-contents__link toc-highlight">Generating a batch of candidates for SCBO</a></li></ul></li><li><a href="#main-optimization-loop" class="table-of-contents__link toc-highlight">Main Optimization Loop</a><ul><li><a href="#plot-results" class="table-of-contents__link toc-highlight">Plot Results</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/botorch/docs/introduction">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/botorch/docs/getting_started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/botorch/docs/tutorials/">Tutorials</a></li><li class="footer__item"><a href="https://botorch-dev.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">API Reference</a></li><li class="footer__item"><a href="https://arxiv.org/abs/1910.06403" target="_blank" rel="noopener noreferrer" class="footer__link-item">Paper<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/pytorch/botorch" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><iframe src="https://ghbtns.com/github-btn.html?user=pytorch&amp;repo=botorch&amp;type=star&amp;count=true&amp;size=small" title="GitHub Stars"></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/botorch/img/meta_opensource_logo_negative.svg" alt="Botorch" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/botorch/img/meta_opensource_logo_negative.svg" alt="Botorch" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright © 2024 Meta Platforms, Inc.</div></div></div></footer></div>
</body>
</html>