"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6302],{9659:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>m,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"tutorials/discrete_multi_fidelity_bo/index","title":"Multi-fidelity Bayesian optimization with discrete fidelities using KG","description":"<LinkButtons","source":"@site/../docs/tutorials/discrete_multi_fidelity_bo/index.mdx","sourceDirName":"tutorials/discrete_multi_fidelity_bo","slug":"/tutorials/discrete_multi_fidelity_bo/","permalink":"/botorch/docs/tutorials/discrete_multi_fidelity_bo/","draft":false,"unlisted":false,"editUrl":"https://github.com/pytorch/botorch/edit/main/docs/../docs/tutorials/discrete_multi_fidelity_bo/index.mdx","tags":[],"version":"current","frontMatter":{"title":"Multi-fidelity Bayesian optimization with discrete fidelities using KG","sidebar_label":"Multi-fidelity Bayesian optimization with discrete fidelities using KG"},"sidebar":"tutorials","previous":{"title":"Multi-fidelity Bayesian optimization using KG","permalink":"/botorch/docs/tutorials/multi_fidelity_bo/"},"next":{"title":"Composite Bayesian optimization with the High Order Gaussian Process","permalink":"/botorch/docs/tutorials/composite_bo_with_hogp/"}}');var t=n(4848),i=n(8453),l=n(8987),r=n(1023);n(290);const c={title:"Multi-fidelity Bayesian optimization with discrete fidelities using KG",sidebar_label:"Multi-fidelity Bayesian optimization with discrete fidelities using KG"},o=void 0,m={},d=[{value:"Multi-Fidelity BO with Discrete Fidelities using KG",id:"multi-fidelity-bo-with-discrete-fidelities-using-kg",level:2},{value:"Set dtype and device",id:"set-dtype-and-device",level:3},{value:"Problem setup",id:"problem-setup",level:3},{value:"Model initialization",id:"model-initialization",level:4},{value:"Define a helper function to construct the MFKG acquisition function",id:"define-a-helper-function-to-construct-the-mfkg-acquisition-function",level:4},{value:"Define a helper function that performs the essential BO step",id:"define-a-helper-function-that-performs-the-essential-bo-step",level:4},{value:"Perform a few steps of multi-fidelity BO",id:"perform-a-few-steps-of-multi-fidelity-bo",level:3},{value:"Make a final recommendation",id:"make-a-final-recommendation",level:3},{value:"Comparison to standard EI (always use target fidelity)",id:"comparison-to-standard-ei-always-use-target-fidelity",level:3}];function h(e){const s={a:"a",annotation:"annotation",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",msup:"msup",p:"p",pre:"pre",semantics:"semantics",span:"span",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.A,{githubUrl:"https://github.com/cristianlara/botorch/blob/main/tutorials/discrete_multi_fidelity_bo/discrete_multi_fidelity_bo.ipynb",colabUrl:"https://colab.research.google.com/github/cristianlara/botorch/blob/main/tutorials/discrete_multi_fidelity_bo/discrete_multi_fidelity_bo.ipynb"}),"\n",(0,t.jsx)(s.h2,{id:"multi-fidelity-bo-with-discrete-fidelities-using-kg",children:"Multi-Fidelity BO with Discrete Fidelities using KG"}),"\n",(0,t.jsxs)(s.p,{children:['In this tutorial, we show how to do multi-fidelity BO with discrete fidelities based on\n[1], where each fidelity is a different "information source." This tutorial uses the\nsame setup as the\n',(0,t.jsx)(s.a,{href:"https://botorch.org/tutorials/multi_fidelity_bo",children:"continuous multi-fidelity BO tutorial"}),",\nexcept with discrete fidelity parameters that are interpreted as multiple information\nsources."]}),"\n",(0,t.jsx)(s.p,{children:"We use a GP model with a single task that models the design and fidelity parameters\njointly. In some cases, where there is not a natural ordering in the fidelity space, it\nmay be more appropriate to use a multi-task model (with, say, an ICM kernel). We will\nprovide a tutorial once this functionality is in place."}),"\n",(0,t.jsxs)(s.p,{children:["[1]\n",(0,t.jsx)(s.a,{href:"https://papers.nips.cc/paper/2017/file/df1f1d20ee86704251795841e6a9405a-Paper.pdf",children:"M. Poloczek, J. Wang, P.I. Frazier. Multi-Information Source Optimization. NeurIPS, 2017"})]}),"\n",(0,t.jsxs)(s.p,{children:["[2]\n",(0,t.jsx)(s.a,{href:"https://arxiv.org/pdf/1903.04703.pdf",children:"J. Wu, S. Toscano-Palmerin, P.I. Frazier, A.G. Wilson. Practical Multi-fidelity Bayesian Optimization for Hyperparameter Tuning. Conference on Uncertainty in Artificial Intelligence (UAI), 2019"})]}),"\n",(0,t.jsx)(s.h3,{id:"set-dtype-and-device",children:"Set dtype and device"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'import os\nimport torch\n\n\ntkwargs = {\n    "dtype": torch.double,\n    "device": torch.device("cuda" if torch.cuda.is_available() else "cpu"),\n}\nSMOKE_TEST = os.environ.get("SMOKE_TEST")\n'})}),"\n",(0,t.jsx)(s.h3,{id:"problem-setup",children:"Problem setup"}),"\n",(0,t.jsxs)(s.p,{children:["We'll consider the Augmented Hartmann multi-fidelity synthetic test problem. This\nfunction is a version of the Hartmann6 test function with an additional dimension\nrepresenting the fidelity parameter; details are in [2]. The function takes the form\n",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"f"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"("}),(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"f(x,s)"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,t.jsx)(s.span,{className:"mopen",children:"("}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mclose",children:")"})]})})]})," where ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mo,{children:"\u2208"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"["}),(0,t.jsx)(s.mn,{children:"0"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsxs)(s.msup,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"]"}),(0,t.jsx)(s.mn,{children:"6"})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"x \\in [0,1]^6"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"\u2208"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mopen",children:"["}),(0,t.jsx)(s.span,{className:"mord",children:"0"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"1"}),(0,t.jsxs)(s.span,{className:"mclose",children:[(0,t.jsx)(s.span,{className:"mclose",children:"]"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsx)(s.span,{className:"vlist-t",children:(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.8141em"},children:(0,t.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"6"})})]})})})})})]})]})]})]})," and ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{children:"\u2208"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mn,{children:"0.5"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"0.75"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"1"})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"s \\in {0.5, 0.75, 1}"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"\u2208"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord",children:"0.5"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"0.75"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"1"})]})]})]})]}),". The target fidelity is 1.0,\nwhich means that our goal is to solve ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsxs)(s.msub,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"max"}),(0,t.jsx)(s.mo,{children:"\u2061"})]}),(0,t.jsx)(s.mi,{children:"x"})]}),(0,t.jsx)(s.mi,{children:"f"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"("}),(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"1.0"}),(0,t.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\\max_x f(x,1.0)"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsxs)(s.span,{className:"mop",children:[(0,t.jsx)(s.span,{className:"mop",children:"max"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"x"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,t.jsx)(s.span,{className:"mopen",children:"("}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"1.0"}),(0,t.jsx)(s.span,{className:"mclose",children:")"})]})})]})," by making use of cheaper\nevaluations ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"f"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"("}),(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"f(x,s)"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,t.jsx)(s.span,{className:"mopen",children:"("}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mclose",children:")"})]})})]})," for ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{children:"\u2208"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mn,{children:"0.5"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"0.75"})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"s \\in {0.5, 0.75}"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"\u2208"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord",children:"0.5"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"0.75"})]})]})]})]}),". In this example, we'll assume that the\ncost function takes the form ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mn,{children:"5.0"}),(0,t.jsx)(s.mo,{children:"+"}),(0,t.jsx)(s.mi,{children:"s"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"5.0 + s"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,t.jsx)(s.span,{className:"mord",children:"5.0"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,t.jsx)(s.span,{className:"mbin",children:"+"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"})]})]})]}),", illustrating a situation where the fixed cost is\n",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mn,{children:"5.0"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"5.0"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6444em"}}),(0,t.jsx)(s.span,{className:"mord",children:"5.0"})]})})]}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"from botorch.test_functions.multi_fidelity import AugmentedHartmann\n\n\nproblem = AugmentedHartmann(negate=True).to(**tkwargs)\nfidelities = torch.tensor([0.5, 0.75, 1.0], **tkwargs)\n"})}),"\n",(0,t.jsx)(s.h4,{id:"model-initialization",children:"Model initialization"}),"\n",(0,t.jsxs)(s.p,{children:["We use a ",(0,t.jsx)(s.code,{children:"SingleTaskMultiFidelityGP"})," as the surrogate model, which uses a kernel from\n[2] that is well-suited for multi-fidelity applications. The ",(0,t.jsx)(s.code,{children:"SingleTaskMultiFidelityGP"}),"\nmodels the design and fidelity parameters jointly, so its domain is ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"["}),(0,t.jsx)(s.mn,{children:"0"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"1"}),(0,t.jsxs)(s.msup,{children:[(0,t.jsx)(s.mo,{stretchy:"false",children:"]"}),(0,t.jsx)(s.mn,{children:"7"})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"[0,1]^7"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mopen",children:"["}),(0,t.jsx)(s.span,{className:"mord",children:"0"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"1"}),(0,t.jsxs)(s.span,{className:"mclose",children:[(0,t.jsx)(s.span,{className:"mclose",children:"]"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsx)(s.span,{className:"vlist-t",children:(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.8141em"},children:(0,t.jsxs)(s.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"7"})})]})})})})})]})]})})]}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from botorch.models.gp_regression_fidelity import SingleTaskMultiFidelityGP\nfrom botorch.models.transforms.outcome import Standardize\nfrom gpytorch.mlls.exact_marginal_log_likelihood import ExactMarginalLogLikelihood\n\n\ndef generate_initial_data(n=16):\n    # generate training data\n    train_x = torch.rand(n, 6, **tkwargs)\n    train_f = fidelities[torch.randint(3, (n, 1))]\n    train_x_full = torch.cat((train_x, train_f), dim=1)\n    train_obj = problem(train_x_full).unsqueeze(-1)  # add output dimension\n    return train_x_full, train_obj\n\n\ndef initialize_model(train_x, train_obj):\n    # define a surrogate model suited for a "training data"-like fidelity parameter\n    # in dimension 6, as in [2]\n    model = SingleTaskMultiFidelityGP(\n        train_x, train_obj, outcome_transform=Standardize(m=1), data_fidelities=[6]\n    )\n    mll = ExactMarginalLogLikelihood(model.likelihood, model)\n    return mll, model\n'})}),"\n",(0,t.jsx)(s.h4,{id:"define-a-helper-function-to-construct-the-mfkg-acquisition-function",children:"Define a helper function to construct the MFKG acquisition function"}),"\n",(0,t.jsxs)(s.p,{children:["The helper function illustrates how one can initialize an ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"q"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"q"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]})})]}),"MFKG acquisition function.\nIn this example, we assume that the affine cost is known. We then use the notion of a\n",(0,t.jsx)(s.code,{children:"CostAwareUtility"}),' in BoTorch to scalarize the "competing objectives" of information\ngain and cost. The MFKG acquisition function optimizes the ratio of information gain to\ncost, which is captured by the ',(0,t.jsx)(s.code,{children:"InverseCostWeightedUtility"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["In order for MFKG to evaluate the information gain, it uses the model to predict the\nfunction value at the highest fidelity after conditioning on the observation. This is\nhandled by the ",(0,t.jsx)(s.code,{children:"project"})," argument, which specifies how to transform a tensor ",(0,t.jsx)(s.code,{children:"X"})," to its\ntarget fidelity. We use a default helper function called ",(0,t.jsx)(s.code,{children:"project_to_target_fidelity"})," to\nachieve this."]}),"\n",(0,t.jsxs)(s.p,{children:["An important point to keep in mind: in the case of standard KG, one can ignore the\ncurrent value and simply optimize the expected maximum posterior mean of the next stage.\nHowever, for MFKG, since the goal is optimize information ",(0,t.jsx)(s.em,{children:"gain"})," per cost, it is\nimportant to first compute the current value (i.e., maximum of the posterior mean at the\ntarget fidelity). To accomplish this, we use a ",(0,t.jsx)(s.code,{children:"FixedFeatureAcquisitionFunction"})," on top\nof a ",(0,t.jsx)(s.code,{children:"PosteriorMean"}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from botorch import fit_gpytorch_mll\nfrom botorch.models.cost import AffineFidelityCostModel\nfrom botorch.acquisition.cost_aware import InverseCostWeightedUtility\nfrom botorch.acquisition import PosteriorMean\nfrom botorch.acquisition.knowledge_gradient import qMultiFidelityKnowledgeGradient\nfrom botorch.acquisition.fixed_feature import FixedFeatureAcquisitionFunction\nfrom botorch.optim.optimize import optimize_acqf\nfrom botorch.acquisition.utils import project_to_target_fidelity\n\nbounds = torch.tensor([[0.0] * problem.dim, [1.0] * problem.dim], **tkwargs)\ntarget_fidelities = {6: 1.0}\n\ncost_model = AffineFidelityCostModel(fidelity_weights={6: 1.0}, fixed_cost=5.0)\ncost_aware_utility = InverseCostWeightedUtility(cost_model=cost_model)\n\n\ndef project(X):\n    return project_to_target_fidelity(X=X, target_fidelities=target_fidelities)\n\n\ndef get_mfkg(model):\n\n    curr_val_acqf = FixedFeatureAcquisitionFunction(\n        acq_function=PosteriorMean(model),\n        d=7,\n        columns=[6],\n        values=[1],\n    )\n\n    _, current_value = optimize_acqf(\n        acq_function=curr_val_acqf,\n        bounds=bounds[:, :-1],\n        q=1,\n        num_restarts=10 if not SMOKE_TEST else 2,\n        raw_samples=1024 if not SMOKE_TEST else 4,\n        options={"batch_limit": 10, "maxiter": 200},\n    )\n\n    return qMultiFidelityKnowledgeGradient(\n        model=model,\n        num_fantasies=128 if not SMOKE_TEST else 2,\n        current_value=current_value,\n        cost_aware_utility=cost_aware_utility,\n        project=project,\n    )\n'})}),"\n",(0,t.jsx)(s.h4,{id:"define-a-helper-function-that-performs-the-essential-bo-step",children:"Define a helper function that performs the essential BO step"}),"\n",(0,t.jsxs)(s.p,{children:["This helper function optimizes the acquisition function and returns the batch\n",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mn,{children:"2"})]}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mo,{children:"\u2026"}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"x"}),(0,t.jsx)(s.mi,{children:"q"})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"{x_1, x_2, \\ldots x_q}"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.7167em",verticalAlign:"-0.2861em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"minner",children:"\u2026"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.1514em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"q"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.2861em"},children:(0,t.jsx)(s.span,{})})})]})})]})]})]})})]})," along with the observed function values. The function\n",(0,t.jsx)(s.code,{children:"optimize_acqf_mixed"})," sequentially optimizes the acquisition function over ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"x"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.4306em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"x"})]})})]})," for each\nvalue of the fidelity ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"s"}),(0,t.jsx)(s.mo,{children:"\u2208"}),(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mn,{children:"0"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"0.5"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mn,{children:"1.0"})]})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"s \\in {0, 0.5, 1.0}"})]})})}),(0,t.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"s"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,t.jsx)(s.span,{className:"mrel",children:"\u2208"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8389em",verticalAlign:"-0.1944em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord",children:"0"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"0.5"}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mord",children:"1.0"})]})]})]})]}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from botorch.optim.optimize import optimize_acqf_mixed\n\n\ntorch.set_printoptions(precision=3, sci_mode=False)\n\nNUM_RESTARTS = 5 if not SMOKE_TEST else 2\nRAW_SAMPLES = 128 if not SMOKE_TEST else 4\nBATCH_SIZE = 4\n\n\ndef optimize_mfkg_and_get_observation(mfkg_acqf):\n    """Optimizes MFKG and returns a new candidate, observation, and cost."""\n\n    # generate new candidates\n    candidates, _ = optimize_acqf_mixed(\n        acq_function=mfkg_acqf,\n        bounds=bounds,\n        fixed_features_list=[{6: 0.5}, {6: 0.75}, {6: 1.0}],\n        q=BATCH_SIZE,\n        num_restarts=NUM_RESTARTS,\n        raw_samples=RAW_SAMPLES,\n        # batch_initial_conditions=X_init,\n        options={"batch_limit": 5, "maxiter": 200},\n    )\n\n    # observe new values\n    cost = cost_model(candidates).sum()\n    new_x = candidates.detach()\n    new_obj = problem(new_x).unsqueeze(-1)\n    print(f"candidates:\\n{new_x}\\n")\n    print(f"observations:\\n{new_obj}\\n\\n")\n    return new_x, new_obj, cost\n'})}),"\n",(0,t.jsx)(s.h3,{id:"perform-a-few-steps-of-multi-fidelity-bo",children:"Perform a few steps of multi-fidelity BO"}),"\n",(0,t.jsx)(s.p,{children:"First, let's generate some initial random data and fit a surrogate model."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"train_x, train_obj = generate_initial_data(n=16)\n"})}),"\n",(0,t.jsx)(s.p,{children:"We can now use the helper functions above to run a few iterations of BO."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"cumulative_cost = 0.0\nN_ITER = 3 if not SMOKE_TEST else 1\n\nfor i in range(N_ITER):\n    mll, model = initialize_model(train_x, train_obj)\n    fit_gpytorch_mll(mll)\n    mfkg_acqf = get_mfkg(model)\n    new_x, new_obj, cost = optimize_mfkg_and_get_observation(mfkg_acqf)\n    train_x = torch.cat([train_x, new_x])\n    train_obj = torch.cat([train_obj, new_obj])\n    cumulative_cost += cost\n"})}),"\n",(0,t.jsx)(r.A,{children:"candidates:\ntensor([[0.199, 0.101, 0.436, 0.433, 0.197, 0.421, 0.750],\n      [0.142, 0.274, 0.308, 0.413, 0.298, 0.570, 0.750],\n      [0.097, 0.141, 0.417, 0.453, 0.477, 0.536, 0.500],\n      [0.123, 0.022, 0.328, 0.430, 0.270, 0.689, 0.500]], device='cuda:0',\n     dtype=torch.float64)\nobservations:\ntensor([[1.369],\n      [2.308],\n      [1.404],\n      [2.297]], device='cuda:0', dtype=torch.float64)"}),"\n",(0,t.jsx)(r.A,{children:"candidates:\ntensor([[0.276, 0.159, 0.231, 0.462, 0.295, 0.633, 1.000],\n      [0.213, 0.163, 0.297, 0.336, 0.276, 0.671, 0.750],\n      [0.029, 0.235, 0.236, 0.405, 0.290, 0.709, 0.500],\n      [0.159, 0.205, 0.360, 0.397, 0.361, 0.717, 1.000]], device='cuda:0',\n     dtype=torch.float64)\nobservations:\ntensor([[2.170],\n      [2.984],\n      [2.197],\n      [2.588]], device='cuda:0', dtype=torch.float64)"}),"\n",(0,t.jsx)(r.A,{children:"candidates:\ntensor([[0.268, 0.224, 0.340, 0.334, 0.230, 0.751, 0.500],\n      [0.263, 0.181, 0.242, 0.307, 0.335, 0.735, 0.500],\n      [0.166, 0.163, 0.345, 0.260, 0.278, 0.711, 0.500],\n      [0.257, 0.238, 0.337, 0.311, 0.316, 0.639, 0.750]], device='cuda:0',\n     dtype=torch.float64)\nobservations:\ntensor([[2.565],\n      [2.818],\n      [3.036],\n      [3.036]], device='cuda:0', dtype=torch.float64)"}),"\n",(0,t.jsx)(s.h3,{id:"make-a-final-recommendation",children:"Make a final recommendation"}),"\n",(0,t.jsx)(s.p,{children:"In multi-fidelity BO, there are usually fewer observations of the function at the target\nfidelity, so it is important to use a recommendation function that uses the correct\nfidelity. Here, we maximize the posterior mean with the fidelity dimension fixed to the\ntarget fidelity of 1.0."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def get_recommendation(model):\n    rec_acqf = FixedFeatureAcquisitionFunction(\n        acq_function=PosteriorMean(model),\n        d=7,\n        columns=[6],\n        values=[1],\n    )\n\n    final_rec, _ = optimize_acqf(\n        acq_function=rec_acqf,\n        bounds=bounds[:, :-1],\n        q=1,\n        num_restarts=10,\n        raw_samples=512,\n        options={"batch_limit": 5, "maxiter": 200},\n    )\n\n    final_rec = rec_acqf._construct_X_full(final_rec)\n\n    objective_value = problem(final_rec)\n    print(f"recommended point:\\n{final_rec}\\n\\nobjective value:\\n{objective_value}")\n    return final_rec\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'final_rec = get_recommendation(model)\nprint(f"\\ntotal cost: {cumulative_cost}\\n")\n'})}),"\n",(0,t.jsx)(r.A,{children:"recommended point:\ntensor([[0.213, 0.164, 0.302, 0.327, 0.283, 0.689, 1.000]], device='cuda:0',\n     dtype=torch.float64)\nobjective value:\ntensor([3.021], device='cuda:0', dtype=torch.float64)\ntotal cost: 68.0"}),"\n",(0,t.jsx)(s.h3,{id:"comparison-to-standard-ei-always-use-target-fidelity",children:"Comparison to standard EI (always use target fidelity)"}),"\n",(0,t.jsx)(s.p,{children:"Let's now repeat the same steps using a standard EI acquisition function (note that this\nis not a rigorous comparison as we are only looking at one trial in order to keep\ncomputational requirements low)."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'from botorch.acquisition import qExpectedImprovement\n\n\ndef get_ei(model, best_f):\n\n    return FixedFeatureAcquisitionFunction(\n        acq_function=qExpectedImprovement(model=model, best_f=best_f),\n        d=7,\n        columns=[6],\n        values=[1],\n    )\n\n\ndef optimize_ei_and_get_observation(ei_acqf):\n    """Optimizes EI and returns a new candidate, observation, and cost."""\n\n    candidates, _ = optimize_acqf(\n        acq_function=ei_acqf,\n        bounds=bounds[:, :-1],\n        q=BATCH_SIZE,\n        num_restarts=10,\n        raw_samples=512,\n        options={"batch_limit": 5, "maxiter": 200},\n    )\n\n    # add the fidelity parameter\n    candidates = ei_acqf._construct_X_full(candidates)\n\n    # observe new values\n    cost = cost_model(candidates).sum()\n    new_x = candidates.detach()\n    new_obj = problem(new_x).unsqueeze(-1)\n    print(f"candidates:\\n{new_x}\\n")\n    print(f"observations:\\n{new_obj}\\n\\n")\n    return new_x, new_obj, cost\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"cumulative_cost = 0.0\n\ntrain_x, train_obj = generate_initial_data(n=16)\n\nfor _ in range(N_ITER):\n    mll, model = initialize_model(train_x, train_obj)\n    fit_gpytorch_mll(mll)\n    ei_acqf = get_ei(model, best_f=train_obj.max())\n    new_x, new_obj, cost = optimize_ei_and_get_observation(ei_acqf)\n    train_x = torch.cat([train_x, new_x])\n    train_obj = torch.cat([train_obj, new_obj])\n    cumulative_cost += cost\n"})}),"\n",(0,t.jsx)(r.A,{children:"candidates:\ntensor([[0.247, 0.687, 0.581, 0.760, 0.093, 0.132, 1.000],\n      [0.319, 0.850, 0.639, 0.865, 0.000, 0.120, 1.000],\n      [0.349, 0.666, 0.555, 0.986, 0.000, 0.126, 1.000],\n      [0.297, 0.792, 0.450, 0.889, 0.034, 0.028, 1.000]], device='cuda:0',\n     dtype=torch.float64)\nobservations:\ntensor([[0.973],\n      [1.091],\n      [0.340],\n      [0.902]], device='cuda:0', dtype=torch.float64)"}),"\n",(0,t.jsx)(r.A,{children:"candidates:\ntensor([[0.194, 0.858, 0.622, 0.799, 0.000, 0.095, 1.000],\n      [0.341, 0.854, 0.590, 0.767, 0.000, 0.085, 1.000],\n      [0.999, 0.439, 0.828, 0.975, 0.633, 0.176, 1.000],\n      [0.296, 0.859, 0.677, 0.806, 0.119, 0.054, 1.000]], device='cuda:0',\n     dtype=torch.float64)\nobservations:\ntensor([[    0.862],\n      [    1.975],\n      [    0.000],\n      [    1.514]], device='cuda:0', dtype=torch.float64)"}),"\n",(0,t.jsx)(r.A,{children:"/data/sandcastle/boxes/fbsource/fbcode/buck-out/opt/gen/bento/kernels/bento_kernel_ae#link-tree/gpytorch/utils/cholesky.py:40: NumericalWarning:\nA not p.d., added jitter of 1.0e-08 to the diagonal"}),"\n",(0,t.jsx)(r.A,{children:"candidates:\ntensor([[0.360, 0.891, 0.588, 0.749, 0.019, 0.036, 1.000],\n      [0.049, 0.894, 0.345, 0.210, 0.482, 0.463, 1.000],\n      [0.398, 0.970, 0.504, 0.213, 0.814, 0.724, 1.000],\n      [0.817, 0.879, 0.691, 0.842, 0.455, 0.937, 1.000]], device='cuda:0',\n     dtype=torch.float64)\nobservations:\ntensor([[2.271],\n      [0.216],\n      [0.055],\n      [0.036]], device='cuda:0', dtype=torch.float64)"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'final_rec = get_recommendation(model)\nprint(f"\\ntotal cost: {cumulative_cost}\\n")\n'})}),"\n",(0,t.jsx)(r.A,{children:"recommended point:\ntensor([[0.352, 0.874, 0.589, 0.756, 0.008, 0.060, 1.000]], device='cuda:0',\n     dtype=torch.float64)\nobjective value:\ntensor([2.166], device='cuda:0', dtype=torch.float64)\ntotal cost: 72.0"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python"})})]})}function p(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},1023:(e,s,n)=>{n.d(s,{A:()=>p});n(6540);var a,t=new Uint8Array(16);function i(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(t)}const l=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const r=function(e){return"string"==typeof e&&l.test(e)};for(var c=[],o=0;o<256;++o)c.push((o+256).toString(16).substr(1));const m=function(e){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[s+0]]+c[e[s+1]]+c[e[s+2]]+c[e[s+3]]+"-"+c[e[s+4]]+c[e[s+5]]+"-"+c[e[s+6]]+c[e[s+7]]+"-"+c[e[s+8]]+c[e[s+9]]+"-"+c[e[s+10]]+c[e[s+11]]+c[e[s+12]]+c[e[s+13]]+c[e[s+14]]+c[e[s+15]]).toLowerCase();if(!r(n))throw TypeError("Stringified UUID is invalid");return n};const d=function(e,s,n){var a=(e=e||{}).random||(e.rng||i)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s){n=n||0;for(var t=0;t<16;++t)s[n+t]=a[t];return s}return m(a)};var h=n(4848);const p=function(e){return(0,h.jsxs)("div",{style:{backgroundColor:"var(--ifm-pre-background)",marginBottom:"10px",borderRadius:"var(--ifm-global-radius)",overflow:"hidden",padding:"5px",font:"var(--ifm-code-font-size) / var(--ifm-pre-line-height) var(--ifm-font-family-monospace)"},children:[(0,h.jsx)("span",{style:{color:"red"},children:"Out: "}),(0,h.jsx)("pre",{style:{margin:"0px",backgroundColor:"inherit",padding:"8px"},children:e.children.split("\n").map((function(e){return(0,h.jsx)("p",{style:{marginBottom:"0px"},children:e},d())}))})]})}},8987:(e,s,n)=>{n.d(s,{A:()=>l});n(6540);var a=n(8774),t=n(3186),i=n(4848);const l=function(e){var s=e.githubUrl,n=e.colabUrl;return(0,i.jsxs)("div",{className:"margin-top--sm margin-bottom--lg",children:[(0,i.jsxs)(a.A,{to:s,className:"button button--outline button--primary margin-right--xs",children:["Open in GitHub",(0,i.jsx)(t.A,{})]}),(0,i.jsxs)(a.A,{to:n,className:"button button--outline button--primary margin--xs",children:["Run in Google Colab",(0,i.jsx)(t.A,{})]})]})}},290:(e,s,n)=>{n(6540),n(3259),n(2303),n(4848)},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>r});var a=n(6540);const t={},i=a.createContext(t);function l(e){const s=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),a.createElement(i.Provider,{value:s},e.children)}}}]);